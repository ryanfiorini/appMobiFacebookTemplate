<!DOCTYPE html><!--HTML5 doctype-->
<html>
<head>
<title>jqMobi Kitchen Sink</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8"> 
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes" />
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">


<link rel="stylesheet" type="text/css" href="fb_demo.css" /> 

<style>
	.scrollBar{background:white;}
    h3 {text-align:center; font-size:35px;}
    ul.iconLinks li {font-size:12px; font-weight:normal;}
    .listbutton {
        display:block;
        border:1px solid black;
        color:black;
        background:orange;
        border-radius:5px;
        width:80%;
        text-decoration:none;
        text-align:center;
        margin:auto;
        margin-bottom:10px;
        height:30px;
        line-height:30px;
    }
    .class16 {
        background:green;
        color:red;
    }
	.jqmscrollBar {background:white !important;}	
	
</style>
<script type="text/javascript" charset="utf-8" src="appmobi_local_bootstrap.js"></script> 

<script type="text/javascript" charset="utf-8" src="jq.mobi.js"></script> 
<script type="text/javascript" charset="utf-8" src="facebook.js"></script> 

<script>
    function loadedPanel(what) {
        //We are going to set the badge as the number of li elements inside the target
    }
    function unloadedPanel(what) {
        console.log("unloaded " + what.id);
    }

    if (!((window.DocumentTouch && document instanceof DocumentTouch) || 'ontouchstart' in window)) {
        var script = document.createElement("script");
        script.src = "plugins/jq.desktopBrowsers.js";
        var tag = $("head").append(script);
        $.os.desktop = true;
    }
    var oldElem = "default";
    function setActiveStyleSheet(title) {
        var a = document.getElementsByTagName("link");
        var currElem;

        if (title == oldElem.getAttribute("title") || oldElem == "default")
            return;
        for (i = 0; i < a.length; i++) {

            if (a[i].getAttribute("title") == title) {
                currElem = a[i];
            }
            else if (!a[i].getAttribute("disabled") && a[i].getAttribute("title"))
                oldElem = a[i];
        }

        currElem.removeAttribute("disabled");
        jq.ui.showMask();
        window.setTimeout(function () {
            jq.ui.hideMask();
            oldElem.setAttribute("disabled", "true");
        }, 500);
    }
    $(document).ready(function () {
        oldElem = document.getElementsByTagName("link")[0];
    });


    function showResponse(type, response) {
        rstr = type + ": " + (response.success ? " SUCCESS" : "FAIL") + "\n";
        data = ((response.data == undefined) ? response.raw : response.data);
        if (response.cancelled == true)
            rstr += " - CANCELLED!";
        alert(rstr + data);
        alert("data: " + typeof (response.data));
        alert("raw: " + typeof (response.raw));
    }

    // Debug code to test and see when events are fired
    /*document.addEventListener('appMobi.facebook.request.response', function (response) { showResponse("GRAPH_API", response) }, false);
    document.addEventListener('appMobi.facebook.dialog.complete', function (response) { showResponse("DIALOG", response) }, false);
    document.addEventListener('appMobi.facebook.dialog.fail', function (response) { showResponse("DIALOG Fail", response) }, false);
    document.addEventListener('appMobi.facebook.login', function (response) { showResponse("LOGIN", response) }, false);
    document.addEventListener('appMobi.facebook.logout', function (response) { showResponse("LOGOUT", response) }, false);
    document.addEventListener('appMobi.facebook.request', function (response) { showResponse("REQUEST", response) }, false);*/

    //  FACEBOOK Implementation
    /*document.addEventListener("appMobi.facebook.login", function (e) {
        if (e.success == true)
        { alert("appMobiFacebookTemplate Log in Successful"); }
        else
        { alert("Unsuccessful Login"); }
    }, false);
    document.addEventListener("appMobi.facebook.logout", function (e) {
        if (e.success == true)
        { alert("Logged out of appMobiFacebookTemplate"); }
        else

        { alert("Unsuccessful Logout"); }
    }, false);*/

    function facebookPostGraph() {
        //name,picture,caption,description,link
        facebookAPI.requestWithGraphAPI("/me/feed", "POST", {
            "name": "Ryan Win8 Template",
            "caption": "GRAPH: Just a test of my appMobi Win 8 Template posting a message!",
            "link": "http://apps.facebook.com/RyanWin8Template/",
            "picture": "http://dev.appmobi.com/documentation/images/possums.jpg",
            "message": "just a test"
        }, function (responseObject) {
            if (responseObject != null && responseObject.success) {
                $("#postGraphResponse").text(responseObject.data.Message);
            } else {
                $("#postGraphResponse").text("post failed");
            }
        });
    }


    function facebookPostFeed() {
        //name,picture,caption,description,link
        facebookAPI.newsFeedDialog({
            "name": "Ryan Win8 Template",
            "caption": "DIALOG: Just a test of my appMobi Win 8 Template posting a message!",
            "link": "http://apps.facebook.com/RyanWin8Template/",
            "picture": "http://dev.appmobi.com/documentation/images/possums.jpg",
            "redirect_uri": "http://fb.appmobi.com/facebook/default.aspx"
        }, function (responseObject) {
            if (responseObject != null && responseObject.success) {
                $("#postFeedResponse").text("post successful");
            } else {
                $("#postFeedResponse").text("post failed");
            }
        });
    }

    function facebookLogin() {
        facebookAPI.login(function (responseObject) {
            //alert('in callback handler: ' + responseObject.data.Message);
            if (responseObject.success) {
                $("#logged-in").show();
                $("#not-logged-in").hide();
            }
        });
    }

    function facebookGetUser() {
        facebookAPI.getUser(function (responseObject) {
            if (responseObject != null) {
                $("#userInfo").text("hi " + responseObject.first_name + " " + responseObject.last_name + " (" + responseObject.username + ")");
            } else {
                $("#userInfo").text("user info not found");
            }
        });
    }

    function facebookGetFriends() {
        facebookAPI.friends("", function (responseObject) {
            if (responseObject != null && responseObject.data && responseObject.data.length > 0) {
                $("#friendCount").text(responseObject.data.length + " friends");
            } else {
                $("#friendCount").text("no friends found");
            }
        });
    }

    function facebookSendDialog() {
        facebookAPI.showAppRequestDialog({
            method: 'send',
            name: 'Make Webapps your HTML5 Expertise',
            link: 'http://www.appmobi.com/?page_id%3D119',
            redirect_uri: 'http://fb.appmobi.com/facebook/default.aspx'
        }, function (responseObject) {
            if (responseObject != null && responseObject.success) {
                $("#sendResponse").text("send successful");
            } else {
                $("#sendResponse").text("send failed");
            }
        });
    }

    function facebookAppRequestDialog() {
        facebookAPI.showAppRequestDialog({
            method: 'apprequests',
            message: 'My Great Win 8 Template Test',
            redirect_uri: 'http://fb.appmobi.com/facebook/default.aspx'
        }, function (responseObject) {
            if (responseObject != null && responseObject.success) {
                $("#appRequestResponse").text("request successful");
            } else {
                $("#appRequestResponse").text("request failed");
            }
        });
    }

    function facebookLogout() {
        //AppMobi.facebook.logout();
        facebookAPI.logout(function (message) {
            $("#logged-in").hide();
            $("#not-logged-in").show();
        });
    }
    //  FACEBOOK Implementation END

</script>

<script type="text/javascript">
    /* This function runs once the page is loaded, but appMobi is not yet active */
    var webRoot = "html/";

    /* This code is used to run as soon as appMobi activates */
    var onDeviceReady = function () {
        if(window.external.notify) window.external.notify('MESSAGE:Hello appMobi');

        console.log("wtfmobi");
        //AppMobi.device.setRotateOrientation("portrait");
        //AppMobi.device.setAutoRotate(false);
        AppMobi.webRoot = window.location.href.match('[^/]*//.*[/]{1}')[0];

        //hide splash screen
        AppMobi.device.hideSplashScreen();

        //initialize the Facebook helper library
        facebookAPI.init();
        //AppMobi.app = 'ace101.ryanwin8fbtemplate';
        AppMobi.app = '502889586389431';

        $("#splashscreen").hide();
        $("#not-logged-in").show();

    };
    document.addEventListener("appMobi.device.ready", onDeviceReady, false);

</script>

</head>
<body>

<div id="jQUi">
	<div title='Welcome' id="main" class="panel" selected="true" data-load="loadedPanel" data-unload="unloadedPanel" data-tab="navbar_home">

        <div id="splashscreen" class='demo_area'>
            <div class="navTile lg" onclick="facebookLogin();">
                <div class="tileIconLogin"></div>
                <p>loading facebook app ...</p>
            </div>

            <div class="infoTile" href="#" style="background:#333 !important;"></div>

            <div class="infoTile" href="#" style="background:#666 !important;">
                <p style="text-align:right; color:#999; font-style:italic; font-size:13px; top:12px; right:12px;"></p>
            </div>

            <div class="clear"></div>
        </div>

        <div id="not-logged-in" class="demo_area">
            <!-- tiles -->
            <div class="navTile lg" onclick="facebookLogin();">
                <div class="tileIconLogin"></div>
                <p>login to facebook</p>
            </div>

            <div class="infoTile" href="#" style="background:#333 !important;"></div>

            <div class="infoTile" href="#" style="background:#666 !important;">
                <p style="text-align:right; color:#999; font-style:italic; font-size:13px; top:12px; right:12px;">You are not logged into Facebook.</p>
            </div>

            <div class="clear"></div>
        </div>


        <div id="logged-in" class="demo_area">
            <!-- tiles -->
            <div class="navTile" onclick="facebookGetUser();">
                <div class="tileIcon getID"></div>
                <p><span id="userInfo">get user </span></p>
            </div>

            <div class="navTile" onclick="facebookGetFriends();">
                <div class="tileIcon getFriends"></div>
                <p><span id="friendCount">get friends </span></p>
            </div>

            <div class="navTile" onclick="facebookPostGraph();">
                <div class="tileIcon post"></div>
                <p><span id="postGraphResponse">post to feed (Graph API) </span></p>
            </div>

            <div class="navTile" onclick="facebookPostFeed();">
                <div class="tileIcon post"></div>
                <p><span id="postFeedResponse">post to feed (Dialog) </span></p>
            </div>

            <div class="navTile" onclick="facebookSendDialog();">
                <div class="tileIcon message"></div>
                <p><span id="sendResponse">send message </span></p>
            </div>

            <div class="navTile" onclick="facebookAppRequestDialog();">
                <div class="tileIcon appRequest"></div>
                <p><span id="appRequestResponse">app request </span></p>
            </div>

            <div class="navTile" onclick="facebookLogout();">
                <div class="tileIcon logOut"></div>
                <p>log out</p>
            </div>

            <div class="clear"></div>
        </div>
    </div>
</div>


<iframe id="appMobi_Facebook_Communication_Frame" style="display: none; width: 100%; height: 100%; top: 0px; left: 0px; position: absolute; z-index: 2147483647; " src=""></iframe>

</body>
</html>
